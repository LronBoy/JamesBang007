<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title></title>
</head>
<body>

<script>
    var vm = new Vue({
        el : '#app',
        data : {
            barrage : {},
            dollSpace01 :0,
            loaded : false,
            btnEnter : false,
            popShow : false,
            popRule : false,
            popTime : false,
            popOdds : false,
            popWin : false,
            popWinCoupon : false,
            popPrize : false,
            popShare : false,
            popCommon : false,
            popAddress : false,
            againShow : false,
            startTime :true,
            todayTasks : {},
            businessList : [],
            LotteryInfo:{},
            LotteryNum : 0,
            dollSet : {},
            paw : {},
            pawL : {},
            pawR : {},
            app : {},
            pirzeList : [],
            isDes : false,
            dollChildX : [],
            speed : 3,
            pawSpeed : 0.003,
            nameArr :['baxi','agenting','deguo','riben','putaoya','yinguo','eluosi','faguo'],
            nameArrS :['baxiS','agentingS','deguoS','ribenS','putaoyaS','yinguoS','eluosiS','faguoS'],
            popText01 : '',
            popText02 : '',
            notWin : false,
            lotteryResult : {},
            winInfo : {},
            mfwURL : 'https://'+window.location.host,
            isLogin : false,
            dollSpace : 0,
            delayTime :0,
            safetyDes : 180,
            explorer : navigator.userAgent,
            convey :{},
            convey01 :{},
            gear :{},
            doll :{},
            w : 0,
            n : 5,
            addressInfo : {},
            isCard : false,
            taskShare : false,
            favorite : false,
            scrollText :[
                {
                    time : '2018/06/27',
                    imgArr : [
                        "https://n2-q.mafengwo.net/s11/M00/3C/76/wKgBEFsfsx-AEsUaAAAKsv2tq1c615.png",
                        "https://b3-q.mafengwo.net/s11/M00/3C/77/wKgBEFsfsx-AEfDZAAAEbAZ2EkI196.png",
                        "https://b2-q.mafengwo.net/s11/M00/3C/78/wKgBEFsfsx-AW581AAAHOYKq2Kc558.png",
                        "https://p4-q.mafengwo.net/s11/M00/3C/7D/wKgBEFsfsx-AbNcnAAAJq5FgI0Q883.png"
                    ]
                },
                {
                    time : '2018/06/28',
                    imgArr : [
                        "https://n1-q.mafengwo.net/s11/M00/B4/A4/wKgBEFszPJ2AE9hqAAAQnUdvwSA089.png",
                        "https://p3-q.mafengwo.net/s11/M00/B4/A4/wKgBEFszPJ2ANiN8AAAIng3xGQQ101.png",
                        "https://n3-q.mafengwo.net/s11/M00/B4/A2/wKgBEFszPJ2AHQIKAAAI-g5L6so602.png",
                        "https://b2-q.mafengwo.net/s11/M00/B4/A5/wKgBEFszPJ2Ab8WmAAAJep1bGZ0813.png",
                        "https://p3-q.mafengwo.net/s11/M00/B4/A6/wKgBEFszPJ2APBwoAAALSHp80Wo061.png"
                    ]
                },
                {
                    time : '2018/06/29',
                    imgArr : [
                        "https://p1-q.mafengwo.net/s11/M00/B4/A7/wKgBEFszPJ2ATzf5AAAMxeoDRgc701.png",
                        "https://p3-q.mafengwo.net/s11/M00/B4/A4/wKgBEFszPJ2ANiN8AAAIng3xGQQ101.png",
                        "https://b1-q.mafengwo.net/s11/M00/B4/9F/wKgBEFszPJ2AOKvoAAAJ9hCEnSg073.png",
                        "https://n1-q.mafengwo.net/s11/M00/B4/A3/wKgBEFszPJ2AGhALAAANxSNda1w107.png"
                    ]
                },
                {
                    time : '2018/06/30',
                    imgArr : [
                        "https://p4-q.mafengwo.net/s11/M00/B4/9E/wKgBEFszPJ2AVJvyAAAJ-cUphDY377.png",
                        "https://p3-q.mafengwo.net/s11/M00/B4/A4/wKgBEFszPJ2ANiN8AAAIng3xGQQ101.png",
                        "https://n4-q.mafengwo.net/s11/M00/B4/A6/wKgBEFszPJ2ABenkAAAJU7lQPrg847.png",
                        "https://n3-q.mafengwo.net/s11/M00/B4/A3/wKgBEFszPJ2APTSFAAALM1nb3U8172.png"
                    ]
                },
                {
                    time : '2018/07/01',
                    imgArr : [
                        "https://p4-q.mafengwo.net/s11/M00/B4/9F/wKgBEFszPJ2AVfJPAAAOO-pLUMg016.png",
                        "https://p3-q.mafengwo.net/s11/M00/B4/A4/wKgBEFszPJ2ANiN8AAAIng3xGQQ101.png",
                        "https://n2-q.mafengwo.net/s11/M00/B4/A9/wKgBEFszPJ2AGnnAAAAJ7gNG6Zg184.png",
                        "https://p4-q.mafengwo.net/s11/M00/B4/9D/wKgBEFszPJ2AS_nCAAAKnqzGQBo456.png"
                    ]
                },
                {
                    time : '2018/07/02',
                    imgArr : [
                        "https://n3-q.mafengwo.net/s11/M00/B4/A5/wKgBEFszPJ2AFCwWAAAMgLAt-9o558.png",
                        "https://p3-q.mafengwo.net/s11/M00/B4/A4/wKgBEFszPJ2ANiN8AAAIng3xGQQ101.png",
                        "https://p1-q.mafengwo.net/s11/M00/B4/9F/wKgBEFszPJ2AM08FAAAJMdqC0ZY082.png",
                        "https://p4-q.mafengwo.net/s11/M00/B4/A1/wKgBEFszPJ2AIIVvAAAKRC6Mm3U545.png"
                    ]
                },
                {
                    time : '2018/07/03',
                    imgArr : [
                        "https://b4-q.mafengwo.net/s11/M00/B4/A1/wKgBEFszPJ2AWIW3AAAJZ8T5vXQ356.png",
                        "https://p3-q.mafengwo.net/s11/M00/B4/A4/wKgBEFszPJ2ANiN8AAAIng3xGQQ101.png",
                        "https://p1-q.mafengwo.net/s11/M00/B4/9F/wKgBEFszPJ2AM08FAAAJMdqC0ZY082.png",
                        "https://p3-q.mafengwo.net/s11/M00/B4/9E/wKgBEFszPJ2AElHCAAAJuuR3DXE166.png"
                    ]
                },
                {
                    time : '2018/07/04',
                    imgArr : [
                        "https://p3-q.mafengwo.net/s11/M00/B4/A8/wKgBEFszPJ2AKUVjAAAOPKV6mmw080.png",
                        "https://p3-q.mafengwo.net/s11/M00/B4/A4/wKgBEFszPJ2ANiN8AAAIng3xGQQ101.png",
                        "https://p1-q.mafengwo.net/s11/M00/B4/9F/wKgBEFszPJ2AM08FAAAJMdqC0ZY082.png",
                        "https://b2-q.mafengwo.net/s11/M00/B4/A0/wKgBEFszPJ2AJim9AAAKFR2LLko375.png"
                    ]
                },
                {
                    time : '2018/07/05',
                    imgArr : [
                        "https://p3-q.mafengwo.net/s11/M00/B4/A7/wKgBEFszPJ2ALJkPAAAMVD1h7Ow525.png",
                        "https://p3-q.mafengwo.net/s11/M00/B4/A4/wKgBEFszPJ2ANiN8AAAIng3xGQQ101.png",
                        "https://p2-q.mafengwo.net/s11/M00/B4/A8/wKgBEFszPJ2APRU5AAAI7RKlwBs949.png",
                        "https://b4-q.mafengwo.net/s11/M00/B4/9E/wKgBEFszPJ2AGahfAAALjkhY0Ww557.png"
                    ]
                },
                {
                    time : '2018/07/06',
                    imgArr : [
                        "https://n4-q.mafengwo.net/s11/M00/B4/A5/wKgBEFszPJ2AbSzrAAAMkMCy1Oo613.png",
                        "https://p3-q.mafengwo.net/s11/M00/B4/A4/wKgBEFszPJ2ANiN8AAAIng3xGQQ101.png",
                        "https://p2-q.mafengwo.net/s11/M00/B4/A8/wKgBEFszPJ2APRU5AAAI7RKlwBs949.png",
                        "https://n4-q.mafengwo.net/s11/M00/B4/A2/wKgBEFszPJ2ADcHaAAAOjoC4QLo747.png"
                    ]
                },
                {
                    time : '2018/07/07',
                    imgArr : [
                        "https://b3-q.mafengwo.net/s11/M00/B4/A5/wKgBEFszPJ2ARjS-AAANLEWtcJ8610.png",
                        "https://p3-q.mafengwo.net/s11/M00/B4/A4/wKgBEFszPJ2ANiN8AAAIng3xGQQ101.png",
                        "https://b3-q.mafengwo.net/s11/M00/B4/A0/wKgBEFszPJ2AQX9xAAAJAPW1o3Y187.png",
                        "https://p1-q.mafengwo.net/s11/M00/B4/A4/wKgBEFszPJ2AfVBuAAAJLIxU5qw158.png"
                    ]
                },
                {
                    time : '2018/07/08',
                    imgArr : [
                        "https://p2-q.mafengwo.net/s11/M00/B4/A3/wKgBEFszPJ2Ac7XlAAAL1uXZ6h8751.png",
                        "https://p3-q.mafengwo.net/s11/M00/B4/A4/wKgBEFszPJ2ANiN8AAAIng3xGQQ101.png",
                        "https://b1-q.mafengwo.net/s11/M00/B4/A7/wKgBEFszPJ2AWDBiAAAJHoBxIek347.png",
                        "https://b4-q.mafengwo.net/s11/M00/B4/A4/wKgBEFszPJ2ATKQaAAALrhSPmwU950.png"
                    ]
                },
                {
                    time : '2018/07/09',
                    imgArr : [
                        "https://p2-q.mafengwo.net/s11/M00/B4/A7/wKgBEFszPJ2ACqRqAAALuILfWOM980.png",
                        "https://b1-q.mafengwo.net/s11/M00/B4/A1/wKgBEFszPJ2AbeRIAAAJAkfDDpg843.png",
                        "https://b1-q.mafengwo.net/s11/M00/B4/A7/wKgBEFszPJ2AWDBiAAAJHoBxIek347.png",
                        "https://p1-q.mafengwo.net/s11/M00/B4/A8/wKgBEFszPJ2ABUf1AAAK-593cS8881.png"
                    ]
                },
                {
                    time : '2018/07/10',
                    imgArr : [
                        "https://n2-q.mafengwo.net/s11/M00/B4/9E/wKgBEFszPJ2AOlebAAAMOAiMil0251.png",
                        "https://n2-q.mafengwo.net/s11/M00/B4/A2/wKgBEFszPJ2AOEeZAAARqDIKi1Q014.png",
                        "https://b4-q.mafengwo.net/s11/M00/B4/A6/wKgBEFszPJ2AMrmOAAAJtrieuHs464.png",
                        "https://p1-q.mafengwo.net/s11/M00/B4/9F/wKgBEFszPJ2AM08FAAAJMdqC0ZY082.png"
                    ]
                },
                {
                    time : '2018/07/11',
                    imgArr : [
                        "https://p1-q.mafengwo.net/s11/M00/B4/A8/wKgBEFszPJ2AOgZ1AAAMV65uhdQ649.png",
                        "https://p2-q.mafengwo.net/s11/M00/B4/A2/wKgBEFszPJ2AT5oNAAAMjHbKMfg317.png",
                        "https://b4-q.mafengwo.net/s11/M00/B4/A6/wKgBEFszPJ2AMrmOAAAJtrieuHs464.png",
                        "https://p1-q.mafengwo.net/s11/M00/B4/9F/wKgBEFszPJ2AM08FAAAJMdqC0ZY082.png"
                    ]
                },
                {
                    time : '2018/07/12',
                    imgArr : [
                        "https://p1-q.mafengwo.net/s11/M00/B4/A8/wKgBEFszPJ2AOgZ1AAAMV65uhdQ649.png",
                        "https://n2-q.mafengwo.net/s11/M00/B4/A1/wKgBEFszPJ2AC0fkAAAMh1HJrLU006.png",
                        "https://b4-q.mafengwo.net/s11/M00/B4/A6/wKgBEFszPJ2AMrmOAAAJtrieuHs464.png",
                        "https://p1-q.mafengwo.net/s11/M00/B4/9F/wKgBEFszPJ2AM08FAAAJMdqC0ZY082.png"
                    ]
                },
                {
                    time : '2018/07/13',
                    imgArr : [
                        "https://n2-q.mafengwo.net/s11/M00/B4/9F/wKgBEFszPJ2AQDxzAAAO07sPuvY925.png",
                        "https://p3-q.mafengwo.net/s11/M00/B4/A4/wKgBEFszPJ2ANiN8AAAIng3xGQQ101.png",
                        "https://b4-q.mafengwo.net/s11/M00/B4/A6/wKgBEFszPJ2AMrmOAAAJtrieuHs464.png",
                        "https://p1-q.mafengwo.net/s11/M00/B4/9F/wKgBEFszPJ2AM08FAAAJMdqC0ZY082.png"
                    ]
                },
                {
                    time : '2018/07/14',
                    imgArr : [
                        "https://n2-q.mafengwo.net/s11/M00/B4/9F/wKgBEFszPJ2AQDxzAAAO07sPuvY925.png",
                        "https://p3-q.mafengwo.net/s11/M00/B4/A4/wKgBEFszPJ2ANiN8AAAIng3xGQQ101.png",
                        "https://b3-q.mafengwo.net/s11/M00/B4/A0/wKgBEFszPJ2AQX9xAAAJAPW1o3Y187.png",
                        "https://p1-q.mafengwo.net/s11/M00/B4/9F/wKgBEFszPJ2AM08FAAAJMdqC0ZY082.png"
                    ]
                },
                {
                    time : '2018/07/15',
                    imgArr : [
                        "https://p3-q.mafengwo.net/s11/M00/B4/A7/wKgBEFszPJ2ALJkPAAAMVD1h7Ow525.png",
                        "https://p3-q.mafengwo.net/s11/M00/B4/A4/wKgBEFszPJ2ANiN8AAAIng3xGQQ101.png",
                        "https://b3-q.mafengwo.net/s11/M00/B4/A0/wKgBEFszPJ2AQX9xAAAJAPW1o3Y187.png",
                        "https://b1-q.mafengwo.net/s11/M00/B4/A7/wKgBEFszPJ2AWDBiAAAJHoBxIek347.png"
                    ]
                },
                {
                    time : '2018/07/16',
                    imgArr : [
                        "https://p3-q.mafengwo.net/s11/M00/B4/A4/wKgBEFszPJ2ANiN8AAAIng3xGQQ101.png",
                        "https://b4-q.mafengwo.net/s11/M00/B4/A6/wKgBEFszPJ2AMrmOAAAJtrieuHs464.png",
                        "https://p1-q.mafengwo.net/s11/M00/B4/9F/wKgBEFszPJ2AM08FAAAJMdqC0ZY082.png",
                        "https://b1-q.mafengwo.net/s11/M00/B4/A7/wKgBEFszPJ2AWDBiAAAJHoBxIek347.png"
                    ]
                },
                {
                    time : '2018/07/17',
                    imgArr : [
                        "https://n2-q.mafengwo.net/s11/M00/B4/9F/wKgBEFszPJ2AQDxzAAAO07sPuvY925.png",
                        "https://p3-q.mafengwo.net/s11/M00/B4/A4/wKgBEFszPJ2ANiN8AAAIng3xGQQ101.png",
                        "https://b3-q.mafengwo.net/s11/M00/B4/A0/wKgBEFszPJ2AQX9xAAAJAPW1o3Y187.png",
                        "https://p1-q.mafengwo.net/s11/M00/B4/9F/wKgBEFszPJ2AM08FAAAJMdqC0ZY082.png"
                    ]
                },
                {
                    time : '2018/07/18',
                    imgArr : [
                        "https://n2-q.mafengwo.net/s11/M00/B4/9F/wKgBEFszPJ2AQDxzAAAO07sPuvY925.png",
                        "https://p3-q.mafengwo.net/s11/M00/B4/A4/wKgBEFszPJ2ANiN8AAAIng3xGQQ101.png",
                        "https://b3-q.mafengwo.net/s11/M00/B4/A0/wKgBEFszPJ2AQX9xAAAJAPW1o3Y187.png",
                        "https://p1-q.mafengwo.net/s11/M00/B4/9F/wKgBEFszPJ2AM08FAAAJMdqC0ZY082.png"
                    ]
                },
            ],
            currScrollText :[],
            uid : Env.UID,
        },
        mounted : function(){
            mfwPageEvent('sales','sales_zuanti',{
                "zuanti_name": '世界杯娃娃机',
                'platform': (navigator.userAgent.indexOf("mfw") > -1) ? 'APP' : 'H5',
                'sales_name': "",
                'sales_id': ''
            });
            var _this = this;
            this.loaded = true;
            this.createCanvas();
            this.scrollBox();
            setTimeout(function(){
                new Swiper('.swiper-container', {
                    loop : true,
                    autoplay: 3000,
                    slidesPerView : 'auto',
                    loopedSlides :30,
                    autoplayDisableOnInteraction : false,
                });
            },1000);
            $.post('/sales/activity/2018worldcup/lottery/recentlyLotteryUser','',function(res){
                _this.LotteryInfo = res.data;
                _this.LotteryNum = res.data.limit;
                Vue.nextTick(function(){
                    _this.scrollBarrage();
                });
            },'json');
            $.post('/sales/activity/2018worldcup/lottery/businessList','',function(res){
                _this.businessList = res.data;
            },'json');
        },
        methods : {
            intoCard : function(){
                window.location.href = "https://imfw.cn/l/13424246";
            },
            submitAddress : function(){
                window.location.href = '/setting/receipt/list?app=36&obj=20180614&backurl='+this.mfwURL+'/sales/activity/2018worldcup/lottery/index';
            },
            tapView : function(value){
                var _this = this;
                if(value.couponId == 0){
                    if(value.awardId == 959){
                        window.location.href = 'https://imfw.cn/l/12911778';
                        mfwPageEvent('sales','sales_zuanti',{
                            "zuanti_name": '世界杯娃娃机',
                            'platform': (navigator.userAgent.indexOf("mfw") > -1) ? 'APP' : 'H5',
                            'sales_name': "点击免错卡查看",
                            'sales_id': ''
                        });
                    }else{
                        $.post('/sales/activity/2018worldcup/lottery/getUserAddress','',function(res){
                            if(res.data.address.content){
                                _this.addressInfo = res.data.address.content;
                                _this.popShow = true;
                                _this.popAddress = true;
                            }else{
                                window.location.href = '/setting/receipt/list?app=36&obj=20180614&backurl='+_this.mfwURL+'/sales/activity/2018worldcup/lottery/index';
                                mfwPageEvent('sales','sales_zuanti',{
                                    "zuanti_name": '世界杯娃娃机',
                                    'platform': (navigator.userAgent.indexOf("mfw") > -1) ? 'APP' : 'H5',
                                    'sales_name': "点击实物查看",
                                    'sales_id': ''
                                });
                            }
                        },'json');
                    }
                }else{
                    window.location.href = '/sales/coupon.php';
                    mfwPageEvent('sales','sales_zuanti',{
                        "zuanti_name": '世界杯娃娃机',
                        'platform': (navigator.userAgent.indexOf("mfw") > -1) ? 'APP' : 'H5',
                        'sales_name': "点击优惠券查看",
                        'sales_id': ''
                    });
                }
            },
            toCard : function(){
                window.location.href = 'https://imfw.cn/l/12911778';
                mfwPageEvent('sales','sales_zuanti',{
                    "zuanti_name": '世界杯娃娃机',
                    'platform': (navigator.userAgent.indexOf("mfw") > -1) ? 'APP' : 'H5',
                    'sales_name': "去瓜分现金",
                    'sales_id': ''
                });
            },
            // canvas
            createCanvas : function(){
                var _this = this,
                    wrap = document.querySelector('.wrapper'),
                    Application = PIXI.Application,
                    loader = PIXI.loader,
                    resources = PIXI.loader.resources,
                    Sprite = PIXI.Sprite;
                this.dollSetBack = new PIXI.Container();
                this.dollSet = new PIXI.Container();
                this.paw = new PIXI.Container();

                this.app = new Application({
                        width: 667,
                        height: 472,
                        antialiasing: true,
                        transparent: true,
                        resolution: 1
                    }
                );
                this.app.renderer.view.style.position = "absolute";
                this.app.renderer.view.style.width = 6.05 + "rem";
                this.app.renderer.view.style.height = 4.28 + "rem";
                this.app.renderer.view.style.left = 0.7 + "rem";
                this.app.renderer.view.style.top = 2.94 + "rem";
                this.app.renderer.view.style.zIndex = 3;
                wrap.appendChild(this.app.view);
                this.app.stage.addChild(this.dollSetBack);
                this.app.stage.addChild(this.dollSet);
                this.app.stage.addChild(this.paw);

                loader.add([
                    {name : 'paw', url:'https://p2-q.mafengwo.net/s11/M00/C8/A9/wKgBEFsVADKAYy_PAAAPcrDgodA418.png'},
                    {name : 'pawLeft', url:'https://b1-q.mafengwo.net/s11/M00/C8/C0/wKgBEFsVAFCAWVoQAAAGhvqcQ8g818.png'},
                    {name : 'pawRight', url:'https://p3-q.mafengwo.net/s11/M00/C8/BF/wKgBEFsVAFCAJc5JAAAGec3QaO0095.png'},
                    {name : 'convey', url:'https://n3-q.mafengwo.net/s11/M00/FE/DD/wKgBEFsgwVSAXugsAAAC6mcS8t4592.png'},
                    {name : 'gear', url:'https://n3-q.mafengwo.net/s11/M00/7A/64/wKgBEFsQGWuAYVaLAAAEFH_xkSU131.png'},
                    {name : 'convey01', url:'https://n2-q.mafengwo.net/s11/M00/DA/B2/wKgBEFsakUqAbhdUAAAGlobEcMc087.png'},
                    {name : 'baxi', url:'https://n1-q.mafengwo.net/s11/M00/95/97/wKgBEFsU2jOAJ7efAAAZtR2vBGw486.png'},
                    {name : 'agenting', url:'https://p4-q.mafengwo.net/s11/M00/95/97/wKgBEFsU2jOAMNK_AAAavw1cHRE001.png'},
                    {name : 'deguo', url:'https://b3-q.mafengwo.net/s11/M00/95/97/wKgBEFsU2jOAQm_hAAAb2QLIozs114.png'},
                    {name : 'riben', url:'https://p3-q.mafengwo.net/s11/M00/A3/CA/wKgBEFsU5Z2AU0uHAAAcGQEljQI493.png'},
                    {name : 'putaoya', url:'https://p4-q.mafengwo.net/s11/M00/A3/CA/wKgBEFsU5Z2ANwvdAAAbKeuZLUI872.png'},
                    {name : 'yinguo', url:'https://p3-q.mafengwo.net/s11/M00/A3/CA/wKgBEFsU5Z2ATONHAAAaZEgmeJA658.png'},
                    {name : 'eluosi', url:'https://p2-q.mafengwo.net/s11/M00/A3/C9/wKgBEFsU5Z2ABM7KAAAbhDASD9Y515.png'},
                    {name : 'faguo', url:'https://b4-q.mafengwo.net/s11/M00/A3/C9/wKgBEFsU5Z2AGv0tAAAaczTL0Co299.png'},
                    {name : 'baxiS', url:'https://n3-q.mafengwo.net/s11/M00/CC/94/wKgBEFsagwaAebmRAAA1dRNXU2w118.png'},
                    {name : 'agentingS', url:'https://p4-q.mafengwo.net/s11/M00/CC/93/wKgBEFsagwaAALPGAAA6wzeVDSA532.png'},
                    {name : 'deguoS', url:'https://n3-q.mafengwo.net/s11/M00/CC/94/wKgBEFsagwaAPsivAAA_6zmbtcc216.png'},
                    {name : 'ribenS', url:'https://n4-q.mafengwo.net/s11/M00/CC/95/wKgBEFsagwaAFhiEAABAPKg43Y8436.png'},
                    {name : 'putaoyaS', url:'https://b3-q.mafengwo.net/s11/M00/CC/94/wKgBEFsagwaAbJcFAAA6mSMAjAc521.png'},
                    {name : 'yinguoS', url:'https://p1-q.mafengwo.net/s11/M00/CC/95/wKgBEFsagwaAQkfCAAA6pw-qplI265.png'},
                    {name : 'eluosiS', url:'https://n1-q.mafengwo.net/s11/M00/CC/94/wKgBEFsagwaAEfIGAAA-O40vYAQ035.png'},
                    {name : 'faguoS', url:'https://p3-q.mafengwo.net/s11/M00/CC/95/wKgBEFsagwaAL0-YAAA671Fivww944.png'},


                ]).load(setup);
                function setup() {
                    var self = _this;
                    // 传送带
                    _this.convey = new Sprite(resources.convey.texture);
                    _this.convey.y = _this.app.renderer.height-_this.convey.height;
                    _this.convey01 = new Sprite(resources.convey01.texture);
                    _this.convey01.x = -_this.convey01.width+_this.app.renderer.width;
                    _this.convey01.y = _this.app.renderer.height-_this.convey01.height-120;
                    // 齿轮
                    for(var i=1; i< 7; i++){
                        gear = new Sprite(resources.gear.texture);
                        gear.x = 74*i+gear.width*i;
                        gear.y = _this.app.renderer.height-gear.height-6;
                        _this.app.stage.addChild(gear);
                    }
                    _this.app.stage.addChildAt(_this.convey);
                    for(var i=1; i< 7; i++){
                        gear01 = new Sprite(resources.gear.texture);
                        gear01.x = 74*i+gear.width*i;
                        gear01.y = _this.app.renderer.height-gear.height-128;
                        _this.app.stage.addChildAt(gear01);
                    }
                    _this.app.stage.addChildAt(_this.convey01);
                    // 娃娃
                    for(var i=0; i< 5; i++){
                        var randomNum = _this.GetRandomNum(0,7);
                        doll = new Sprite(resources[_this.nameArr[randomNum]].texture);
                        _this.dollSpace = (_this.app.renderer.width-doll.width*4)/4;
                        doll.x = (doll.width+_this.dollSpace)*i;
                        _this.dollSet.addChild(doll);
                    }
                    _this.dollSet.x = 0;
                    _this.dollSet.y = _this.app.renderer.height-doll.height-50;

                    for(var i=0; i< 5; i++){
                        var randomNum = _this.GetRandomNum(0,7);
                        doll = new Sprite(resources[_this.nameArrS[randomNum]].texture);
                        _this.dollSpace01 = (_this.app.renderer.width-doll.width*4)/4;
                        doll.x = (doll.width+_this.dollSpace01)*i;
                        _this.dollSetBack.addChild(doll);
                    }
                    _this.dollSetBack.x = -_this.dollSetBack.children[0].width;
                    _this.dollSetBack.y = _this.app.renderer.height-doll.height-160;

                    //爪子
                    var pawC = new Sprite(
                        resources.paw.texture
                    );
                    _this.pawL = new Sprite(
                        resources.pawLeft.texture
                    );
                    _this.pawL.x = 5;
                    _this.pawL.y = 230;
                    _this.pawR = new Sprite(
                        resources.pawRight.texture
                    );
                    _this.pawR.x = pawC.width-6;
                    _this.pawR.y = 230;
                    _this.pawL.pivot.set(21,0);
                    _this.pawL.rotation = 0;
                    _this.pawR.rotation = 0;
                    _this.paw.addChildAt(pawC);
                    _this.paw.addChildAt(_this.pawL);
                    _this.paw.addChildAt(_this.pawR);
                    _this.paw.x = _this.app.renderer.width/2-15;
                    _this.paw.y = -180;
                    var speed = 0.05;
                    _this.app.ticker.add(function(delta){
                        self.conveyLoop();
                        self.conveyLoopBack();
                        self.pawAnimate();
                        self.pawCatch();
                        dollSetLoop();
                        dollSetLoopSmall();
                    });
                    // 娃娃
                    function dollSetLoop(){
                        _this.dollSet.x -=_this.speed;
                        if(_this.dollSet.x <= (-_this.dollSet.children[0].width-_this.dollSpace)*(_this.n-4)){
                            if(_this.w == 5){
                                _this.w=0;
                            }
                            _this.dollSet.removeChild(_this.dollSet.children[_this.w]);
                            var random = _this.GetRandomNum(0,7);
                            var dollLast = new PIXI.Sprite(resources[_this.nameArr[random]].texture);
                            dollLast.x = (dollLast.width+_this.dollSpace)*_this.n;
                            _this.dollSet.addChildAt(dollLast,_this.w);
                            _this.n = _this.n+1;
                            _this.w = _this.w+1;
                        }
                    }
                    var e=0,m =5;
                    function dollSetLoopSmall(){
                        _this.dollSetBack.x +=2;
                        if(_this.dollSetBack.x >= (92+_this.dollSpace01)*(m-5)){
                            if(e == 0){
                                m = 5;
                            }
                            _this.dollSetBack.removeChild(_this.dollSetBack.children[m-1]);
                            var random = _this.GetRandomNum(0,7);
                            var dollLast01 = new Sprite(PIXI.loader.resources[_this.nameArrS[random]].texture);
                            dollLast01.x = -(92+_this.dollSpace01)*(e+1);
                            _this.dollSetBack.addChildAt(dollLast01,(m-1));
                            e = e+1;
                            m = m+1;
                        }
                    }
                }
            },
            // 传送带
            conveyLoop: function(){
                if(this.convey.x <= -this.app.renderer.width+100){
                    this.convey.x = 0;
                }else{
                    this.convey.x -=3;
                }
            },
            conveyLoopBack : function(){
                if(this.convey01.x >= -1){
                    this.convey01.x = -this.convey01.width+this.app.renderer.width;
                }else{
                    this.convey01.x +=2;
                }
            },
            tapGrab : function(){
                var _this = this;
                if(Env.UID && Env){
                    $.post('/sales/activity/2018worldcup/lottery/lottery',{
                        deviceId : SMSdk.getDeviceId()
                    },function(res){
                        _this.lotteryResult = res;
                        if(_this.LotteryNum > 0){
                            _this.LotteryNum = _this.LotteryNum-1;
                        }
                        _this.lottery();
                    },'json');
                    mfwPageEvent('sales', 'sales_activity_game_page_click',
                        {
                            "page_name": '世界杯娃娃机',
                            "open_udid": '',
                            "uid": _this.uid,
                            "param": 'grab 抓取',
                            "activity_id" : 190,
                        });
                }else{
                    window.location.href = 'https://passport.mafengwo.cn/?return_url='+ this.mfwURL +'/sales/activity/2018worldcup/lottery/index';
                }
            },
            honeyLottery : function(){
                this.tapClose();
                var _this = this;
                $.post('/sales/activity/2018worldcup/lottery/honeyLottery',{
                    deviceId : SMSdk.getDeviceId(),
                },function(res){
                    _this.lotteryResult = res;
                    _this.lottery();
                })
            },
            toLogin : function(){
                window.location.href = 'https://passport.mafengwo.cn/?return_url='+ this.mfwURL +'/sales/activity/2018worldcup/lottery/index';
            },
            tapRule : function(){
                this.popShow = true;
                this.popRule = true;
            },
            tapPrize : function(){
                var _this = this;
                if(Env && Env.UID){
                    $.post('/sales/activity/2018worldcup/lottery/myAwards','',function(res){
                        if(res.errno == 0){
                            _this.pirzeList = res.data;
                            _this.popShow = true;
                            _this.popPrize = true;
                        }
                    },'json');
                    mfwPageEvent('sales', 'sales_activity_game_page_click',
                        {
                            "page_name": '世界杯娃娃机',
                            "open_udid": '',
                            "uid": _this.uid,
                            "param": 'my_gift 我的礼品',
                            "activity_id" : 190,
                        });
                }else{
                    window.location.href = 'https://passport.mafengwo.cn/?return_url='+ this.mfwURL +'/sales/activity/2018worldcup/lottery/index';
                }
            },
            tapOdds : function(){
                var _this = this;
                if(Env.UID && Env){
                    this.isLogin = false;
                }else{this.isLogin = true;}
                $.post('/sales/activity/2018worldcup/lottery/todayTasks','',function(res){
                    _this.todayTasks = res.data;
                    if(res.data.taskFavorite){
                        _this.favorite = false;
                    }else{
                        _this.favorite = true;
                    }
                    if(res.data.taskShare){
                        _this.taskShare = false;
                    }else{
                        _this.taskShare = true;
                    }
                    _this.popShow = true;
                    _this.popOdds = true;
                },'json');
                mfwPageEvent('sales', 'sales_activity_game_page_click',
                    {
                        "page_name": '世界杯娃娃机',
                        "open_udid": '',
                        "uid": _this.uid,
                        "param": 'more_chance 更多机会',
                        "activity_id" : 190,
                    });
            },
            tapClose : function(){
                this.popShow = false;
                this.popPrize = false;
                this.popRule = false;
                this.popTime = false;
                this.popOdds = false;
                this.popWin = false;
                this.popShare = false;
                this.popWinCoupon = false;
                this.popCommon = false;
                this.popAddress = false;
                this.lotteryResult = {};
                this.isDes = false;
                this.pawL.rotation = 0;
                this.pawR.rotation = 0;
                this.app.ticker.start();
            },
            businessHref : function(v){
                mfwPageEvent('sales','sales_zuanti',{
                    "zuanti_name": '世界杯娃娃机',
                    'platform': (navigator.userAgent.indexOf("mfw") > -1) ? 'APP' : 'H5',
                    'sales_name': "赞助商家点击",
                    'sales_id': ''
                });
                window.location.href = "/sales/shop/"+v.otaId;
            },
            toShare : function(){
                var _this = this;
                mfwPageEvent('sales','sales_zuanti',{
                    "zuanti_name": '世界杯娃娃机',
                    'platform': (navigator.userAgent.indexOf("mfw") > -1) ? 'APP' : 'H5',
                    'sales_name': "去分享",
                    'sales_id': ''
                });
                $.post('/sales/activity/2018worldcup/lottery/shareAddOpportunity','',function(res){
                    if(res.errno == 0){
                        if (_this.explorer.indexOf('mfw') >= 0) {
                            MFWAPP.share.showSharePanel();
                            MFWAPP.share.event_addShareResultListener(function (result) {
                                window.location.href = '/sales/activity/2018worldcup/lottery/index';
                                if(result.status == 'success') {}
                            });
                        } else {
                            // 分享弹层
                            _this.popShow = true;
                            _this.popOdds = false,
                                _this.popShare = true;
                        }
                    }
                },'json');
            },
            toCatch: function(){
                for(var i=0; i<this.dollSet.children.length; i++){
                    var dollCenter = this.dollSet.toGlobal(this.dollSet.children[i].position).x+this.dollSet.children[i].width/2-this.app.renderer.width/2-18;
                    if(dollCenter >= this.safetyDes){
                        this.dollChildX = i;
                        this.delayTime = Math.floor((dollCenter-this.safetyDes)/180 *1000);
                        break;
                    }
                }
            },
            // 生成随机数
            GetRandomNum : function(Min,Max){
                var Range = Max - Min;
                var Rand = Math.random();
                return(Min + Math.round(Rand * Range));
            },
            // 碰撞
            // hitImgAni : function (callback){
            //     var _this = this;
            //     if(hitTestRectangle(this.paw, this.dollSet)){
            //         this.isDes = true;
            //         var pawX = this.paw.x+this.paw.width/2;
            //         for(var i=0; i<this.dollSet.children.length; i++){
            //             var desNear = pawX-(this.dollSet.toGlobal(this.dollSet.children[i].position).x+this.dollSet.children[i].width/2);
            //             this.dollChildX.push(Math.abs(desNear));
            //         }
            //         var copyArr = this.dollChildX.slice();
            //         copyArr.sort(function(a,b){
            //             return a-b;
            //         });
            //         var currDollIndex = this.dollChildX.indexOf(copyArr[0]);
            //         this.speed = 0;
            //         this.pawSpeed = 0;
            //         this.dollSet.children[currDollIndex].x = Math.abs(this.dollSet.x)+this.paw.x-(this.dollSet.children[currDollIndex].width/2)+this.paw.width/2;
            //
            //         this.app.ticker.add(function(delta){
            //             if(_this.dollSet.children[currDollIndex].y >= -140 ){
            //                 _this.dollSet.children[currDollIndex].y -= 2;
            //             }
            //         });
            //     }
            //     if(this.isDes){
            //         if(this.paw.y !== -170){
            //             this.paw.y -= 2;
            //         }else{
            //             callback();
            //         }
            //     }else{
            //         this.paw.y += 2;
            //         _this.pawL.rotation += -_this.pawSpeed;
            //         _this.pawR.rotation += _this.pawSpeed;
            //     }
            // },
            // 不碰撞
            pawCatch : function(){
                var _this = this;
                if(this.lotteryResult && this.lotteryResult.errno == 0){
                    setTimeout(function(){
                        if(_this.isDes){
                            if(_this.paw.y !== -_this.speed*60){
                                _this.paw.y -= _this.speed;
                                _this.dollSet.children[_this.dollChildX].x = -_this.dollSet.x + _this.app.renderer.width/2 -35;
                                _this.dollSet.children[_this.dollChildX].y += -_this.speed;
                            }else{
                                _this.app.ticker.stop();
                                if(_this.lotteryResult.data.need_addr == 0){
                                    if(_this.lotteryResult.data.award_id == 959){
                                        _this.popShow = true;
                                        _this.popWinCoupon = true;
                                        _this.isCard = true;
                                    }else{
                                        _this.popShow = true;
                                        _this.popWinCoupon = true;
                                        _this.isCard = false;
                                    }
                                }else{
                                    _this.popShow = true;
                                    _this.popWin = true;
                                }
                                _this.dollSet.children[_this.dollChildX].visible = false;
                            }
                        }else{
                            _this.paw.y += _this.speed;
                            if(_this.paw.y >= -40 && _this.pawR.rotation <= 0.4){
                                _this.pawL.rotation += -_this.pawSpeed;
                                _this.pawR.rotation += _this.pawSpeed;
                            }
                            if(_this.paw.y >= 0){
                                _this.isDes = true;
                            }
                        }
                    },this.delayTime);
                }
            },
            pawAnimate : function(){
                var speed = 0.05;
                if(this.lotteryResult && this.lotteryResult.errno == 435){                //clicked lottery btn
                    if(this.isDes){         // 极限距离
                        if(this.paw.y !== -this.speed*60){
                            this.paw.y -= this.speed;
                            if(this.paw.y <= -90 && this.pawR.rotation >= 0){
                                this.pawL.rotation += speed-0.02;
                                this.pawR.rotation += -speed+0.02;
                            }
                        }else{
                            this.app.ticker.stop();
                            this.popShow = true;
                            this.popCommon = true;   //alert
                        }
                    }else{
                        this.paw.y += this.speed;
                        if(this.paw.y >= -40 && this.pawR.rotation <= 0.4){
                            this.pawL.rotation += -speed;
                            this.pawR.rotation += speed;
                        }
                        if(this.paw.y >= 0){
                            this.isDes = true;
                        }
                    }
                }
            },
            // prizePop
            lottery : function(){
                var _this = this;
                if(this.lotteryResult.errno == 0){
                    this.winInfo = this.lotteryResult.data;
                    this.btnEnter = true;
                    setTimeout(function(){
                        _this.btnEnter = false;
                    },300);
                    this.toCatch(function(){
                        if(_this.lotteryResult.data.need_addr == 0){
                            _this.popShow = true;
                            _this.popWinCoupon = true;
                        }else{
                            _this.popShow = true;
                            _this.popWin = true;
                        }
                        _this.app.ticker.stop();
                    });
                }else if(this.lotteryResult.errno == 400){
                    this.popShow = true;
                    this.popTime = true;
                    this.startTime = true;
                }else if(this.lotteryResult.errno == 405){
                    this.popShow = true;
                    this.popTime = true;
                    this.startTime = false;
                }else if(this.lotteryResult.errno == 415){
                    this.popShow = true;
                    this.popCommon = true;
                    this.notWin = false;
                    this.popText01 = '抓娃娃机机会已经用光';
                    this.popText02 = '先赚取机会在来吧';
                    this.againShow = false;
                }else if(this.lotteryResult.errno == 420){
                    this.popShow = true;
                    this.popCommon = true;
                    this.notWin = false;
                    this.popText01 = '抓娃娃机机会已经用光';
                    this.popText02 = '是否消耗10蜂蜜再抓一次';
                    this.againShow = true;
                }else if(this.lotteryResult.errno == 425){
                    this.popShow = true;
                    this.popCommon = true;
                    this.notWin = false;
                    this.popText01 = '抓娃娃机机会已经用光';
                    this.popText02 = '明日再来吧';
                    this.againShow = false;
                }else if(this.lotteryResult.errno == 435){
                    this.notWin = true;
                    this.popText01 = '很遗憾没有抓到娃娃';
                }else if(this.lotteryResult.errno == 440){
                    this.popShow = true;
                    this.popCommon = true;
                    this.notWin = false;
                    this.popText01 = '蜂蜜不足';
                    this.againShow = false;
                }else if(this.lotteryResult.errno == 445){
                    this.popShow = true;
                    this.popCommon = true;
                    this.notWin = false;
                    this.popText01 = '蜂蜜不足';
                    this.popText02 = '先赚取机会在来吧';
                    this.againShow = false;
                }else{
                    alert('崩溃了！稍后再试');
                }
            },
            scrollBox : function(){
                var getData = new Date().getTime();
                var ul = document.getElementById('scroll'),
                    img = ul.getElementsByTagName('img');
                var num = 0;
                for(var i=0; i<this.scrollText.length; i++){
                    var setTime = new Date(this.scrollText[i].time).getTime();
                    if(getData <= setTime){
                        this.currScrollText = this.scrollText[i-1].imgArr;
                        break;
                    }
                }
                var num2 =0;
                setTimeout(function(){
                    ul.innerHTML += ul.innerHTML;
                    for(var i=0;i<$("#scroll li").length;i++){
                        num2 += ($("#scroll li").eq(i).width()+10);
                    }
                    $("#scroll").width(num2);
                    setInterval(function(){
                        num -= 0.5;
                        num <= -$("#scroll").width()/2 ? num = 0 : num;
                        ul.style.left = num + "px";
                    },10);
                },1000);
            },
            scrollBarrage : function(){
                var loop_length = document.querySelectorAll(".barrage p").length,
                    dur_time = 3,
                    up_velocity = "-=" + (loop_length - 1) * dur_time;
                var awardLoop = new TimelineMax({
                    repeat: -1
                });
                awardLoop.staggerTo(".barrage p", 1, {
                    ease: Power4.easeOut,
                    x: 0,
                    y: 0,
                    opacity: 1
                }, dur_time)
                    .staggerTo(".barrage p", 1, {
                        ease: Sine.easeOut,
                        x: 0,
                        y: -50,
                        opacity: 0
                    }, dur_time, up_velocity);
            },
            toBrandwall : function(){
                var _this = this;
                window.location.href = 'https://imfw.cn/l/12912126';
                mfwPageEvent('sales', 'sales_activity_game_page_click',
                    {
                        "page_name": '世界杯娃娃机',
                        "open_udid": '',
                        "uid": _this.uid,
                        "param": 'brands 品牌墙',
                        "activity_id" : 190,
                    });
            },
            // 热销好货
            toHotGoods : function(){
                var _this = this;
                window.location.href = 'https://imfw.cn/l/14238238';
                mfwPageEvent('sales', 'sales_activity_game_page_click',
                    {
                        "page_name": '世界杯娃娃机',
                        "open_udid": '',
                        "uid": _this.uid,
                        "param": 'sales 热销好货',
                        "activity_id" : 190,
                    });
            },
        }
    });
</script>


</body>
</html>